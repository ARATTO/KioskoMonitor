var _0x33fb=['root/cimv2','\x20Printer\x20Status:\x20','connect','registrar_log','ipID','toString','\x20Error\x20Desciption:\x20','checkPrinterStatus','\x20|Estado\x20de\x20error\x20extendido\x20','Model','emit','SystemName','strDetectedErrorstate','moveNext','Select\x20*\x20from\x20Win32_OperatingSystem','Select\x20*\x20from\x20Win32_DiskDrive\x20where\x20Size>0','Description','|\x20LastErrorCode=\x20','ipClienteX=','Size','|\x20Estado\x20de\x20error\x20detectado:','esPrinterZebra','LastErrorCode','ver_hwClienteData','SELECT\x20*\x20FROM\x20Win32_Processor','Manufacturer','Version','detalle_hwCliente','Papel\x20en\x20puerta\x20de\x20salida','strExtendedDetectedErrorState','printerName','OSArchitecture','Name','Default\x20Printer\x20no\x20es\x20Marca\x20Zebra','|\x20controlpapel=\x20','InterfaceType','generalState','DriverName','Listo,\x20Otro\x20Printer','Error','textStatus','Listo','Select\x20*\x20from\x20Win32_PhysicalMemory','Caption','status','Capacity','toFixed','Status','Default','push','ExtendedDetectedErrorState','item','extendedDetectedErrorState','control','noerror','DeviceLocator','ExecQuery','ErrorDescription','atEnd','SELECT\x20*\x20FROM\x20Win32_Printer','WbemScripting.SWbemLocator'];(function(_0x2b251f,_0x33fb29){var _0x42d3ac=function(_0x4d1992){while(--_0x4d1992){_0x2b251f['push'](_0x2b251f['shift']());}};_0x42d3ac(++_0x33fb29);}(_0x33fb,0x119));var _0x42d3=function(_0x2b251f,_0x33fb29){_0x2b251f=_0x2b251f-0x0;var _0x42d3ac=_0x33fb[_0x2b251f];return _0x42d3ac;};var printerName='Zebra\x20TTP\x202030';var clientIP=cliente['IP'];var ipAsID=clientIP['replace'](/[.]/g,'');var serverIP=servidor['IP'];var controlPapelSalida=0x0;var intentos=0x6;var cambioListo=![];var prStatus=-0x1,strPrinterStatus=-0x1,prExtendedPrinterstatus=-0x1,prTextStatus=-0x1;var prDetectedErrorState=-0x1,strDetectedErrorstate=-0x1,prExtendedDetectedErrorState=-0x1,strExtendedDetectedErrorState=-0x1;var prLastStatus=_0x42d3('0x11'),prLastErrorCode=-0x1,strLastErrorCode=-0x1,strErrorDescription=-0x1;var myPrinter={};var existeError=![];var existiaError=![];var locator=new ActiveXObject(_0x42d3('0x17'));var service=locator['ConnectServer']('.',_0x42d3('0x18'));var socket=io[_0x42d3('0x1a')](serverIP,{'query':_0x42d3('0x2a')+ipAsID});var app={'checkPrinterStatus':function(){var _0x42060f=service[_0x42d3('0x13')](_0x42d3('0x16'));var _0x3da774=new Enumerator(_0x42060f);var _0x4a9c65=0x1;for(;!_0x3da774[_0x42d3('0x15')]();_0x3da774[_0x42d3('0x25')]()){var _0x29e8c1=_0x3da774[_0x42d3('0xe')]();if(_0x29e8c1[_0x42d3('0xb')]==!![]){printerName=_0x29e8c1['caption'];prStatus=_0x29e8c1['printerStatus'];prExtendedPrinterstatus=_0x29e8c1['ExtendedPrinterStatus'];prDetectedErrorState=_0x29e8c1['DetectedErrorState'];prExtendedDetectedErrorState=_0x29e8c1[_0x42d3('0xd')];prTextStatus=_0x29e8c1['status'];prDriverName=_0x29e8c1[_0x42d3('0x0')];if(_0x29e8c1['PrinterState']===0x808){prDetectedErrorState=0x8;prExtendedDetectedErrorState=0x8;}prLastErrorCode=_0x29e8c1[_0x42d3('0x2e')]||-0x1;strErrorDescription=_0x29e8c1[_0x42d3('0x14')]||-0x1;}_0x4a9c65++;}},'showResults':function(){alert(printerName+_0x42d3('0x19')+prStatus+'\x20'+myPrinter['strPrinterStatus']+'|\x20Extended\x20Prn\x20Status:\x20'+prExtendedPrinterstatus+_0x42d3('0x2c')+prDetectedErrorState+'\x20'+myPrinter[_0x42d3('0x24')]+_0x42d3('0x20')+prExtendedDetectedErrorState+'\x20'+myPrinter[_0x42d3('0x35')]+_0x42d3('0x29')+prLastErrorCode+_0x42d3('0x1e')+strErrorDescription+_0x42d3('0x3a')+controlPapelSalida);},'sendData':function(){myPrinter=evaluaEstadoPrinter({'prStatus':prStatus,'prExtendedPrinterstatus':prExtendedPrinterstatus,'prDetectedErrorState':prDetectedErrorState,'prExtendedDetectedErrorState':prExtendedDetectedErrorState});myPrinter['ip']=clientIP;myPrinter[_0x42d3('0x1c')]=ipAsID;myPrinter[_0x42d3('0x3')]=prTextStatus;myPrinter[_0x42d3('0x36')]=printerName;myPrinter[_0x42d3('0x2d')]=esprinterZebra(myPrinter[_0x42d3('0x36')]);myPrinter[_0x42d3('0x10')]=controlPapelSalida;if(myPrinter[_0x42d3('0x3c')]==='-1'){if(myPrinter['detectedErrorState']===_0x42d3('0x34')||myPrinter[_0x42d3('0xf')]===_0x42d3('0x34')){if(controlPapelSalida>=intentos){myPrinter[_0x42d3('0x3c')]='Error';controlPapelSalida++;cambioListo=!![];}else{controlPapelSalida++;myPrinter[_0x42d3('0x3c')]=_0x42d3('0x4');}}else{myPrinter[_0x42d3('0x3c')]=_0x42d3('0x2');controlPapelSalida=0x0;}}if(myPrinter[_0x42d3('0x2d')]===![]&&myPrinter[_0x42d3('0x3c')]===_0x42d3('0x4')){myPrinter[_0x42d3('0x3c')]=_0x42d3('0x1');myPrinter[_0x42d3('0xf')]=_0x42d3('0x39');}socket[_0x42d3('0x22')]('ver_status',myPrinter);if(myPrinter[_0x42d3('0x3c')]==='Listo'&&prLastStatus!==_0x42d3('0x11')){if(cambioListo){controlPapelSalida=0x0;cambioListo=![];}socket['emit'](_0x42d3('0x1b'),myPrinter);prLastStatus=_0x42d3('0x11');}if(myPrinter[_0x42d3('0x3c')]!==_0x42d3('0x4')){if(myPrinter[_0x42d3('0x3')]!==prLastStatus){prLastStatus=myPrinter[_0x42d3('0x3')];socket[_0x42d3('0x22')](_0x42d3('0x1b'),myPrinter);}}},'initialize':function(){'use strict';var _0x46f9f6=this;_0x46f9f6[_0x42d3('0x1f')]();_0x46f9f6['sendData']();}};function socket_enviar(){app['initialize']();};var sendingData=setInterval(socket_enviar,0x1388);socket['on'](_0x42d3('0x2f'),function(_0x2272c2){if(_0x2272c2===ipAsID){var _0x56efb9=service[_0x42d3('0x13')](_0x42d3('0x26'));var _0x3aa636=new Enumerator(_0x56efb9);var _0x49dcd9;for(;!_0x3aa636[_0x42d3('0x15')]();_0x3aa636['moveNext']()){var _0x186792=_0x3aa636[_0x42d3('0xe')]();_0x49dcd9={'Nombre':_0x186792[_0x42d3('0x6')],'Arquitect':_0x186792[_0x42d3('0x37')][_0x42d3('0x1d')](),'Version':_0x186792[_0x42d3('0x32')],'Estado':_0x186792[_0x42d3('0xa')]};}var _0xa50e88=service[_0x42d3('0x13')](_0x42d3('0x30'));var _0x49a35e=new Enumerator(_0xa50e88);var _0x1f2657;for(;!_0x49a35e[_0x42d3('0x15')]();_0x49a35e[_0x42d3('0x25')]()){var _0x119504=_0x49a35e[_0x42d3('0xe')]();_0x1f2657={'Nombre':_0x119504[_0x42d3('0x38')],'NombrePc':_0x119504[_0x42d3('0x23')]};}var _0xf8473d=service[_0x42d3('0x13')](_0x42d3('0x5'));var _0x223076=new Enumerator(_0xf8473d);var _0x404710=[];for(;!_0x223076[_0x42d3('0x15')]();_0x223076['moveNext']()){var _0x366470=_0x223076[_0x42d3('0xe')]();var _0x370703=0x0;;_0x370703=Number(_0x366470[_0x42d3('0x8')])/0x400/0x400;_0x404710[_0x42d3('0xc')]({'Ubicacion':_0x366470[_0x42d3('0x12')],'Fabricante':_0x366470[_0x42d3('0x31')],'Capacidad':_0x370703,'Estado':_0x366470[_0x42d3('0x7')]});}var _0x18dd1f=service[_0x42d3('0x13')](_0x42d3('0x27'));var _0x18c26b=new Enumerator(_0x18dd1f);var _0x5927de=[];for(;!_0x18c26b[_0x42d3('0x15')]();_0x18c26b[_0x42d3('0x25')]()){var _0x30ed94=_0x18c26b[_0x42d3('0xe')]();var _0x14ff5e=(Number(_0x30ed94[_0x42d3('0x2b')])+0x20000000)/0x40000000;_0x5927de[_0x42d3('0xc')]({'Fabricante':_0x30ed94[_0x42d3('0x31')],'Modelo':_0x30ed94[_0x42d3('0x21')],'Size':_0x14ff5e[_0x42d3('0x9')](0x2),'SerialNum':_0x30ed94['SerialNumber'],'Estado':_0x30ed94['Status'],'Descripcion':_0x30ed94[_0x42d3('0x28')],'CodigoError':_0x30ed94['ConfigManagerErrorCode'],'LastErrorCode':_0x30ed94[_0x42d3('0x2e')],'Interface':_0x30ed94[_0x42d3('0x3b')]});}socket[_0x42d3('0x22')](_0x42d3('0x33'),_0x49dcd9,_0x1f2657,_0x404710,_0x5927de);}});